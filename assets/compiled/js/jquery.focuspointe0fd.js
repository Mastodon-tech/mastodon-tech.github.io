!function(t){var i={reCalcOnWindowResize:!0,throttleDuration:17},n=function(i,n){t("<img />").one("load",function(){n(null,{width:this.width,height:this.height})}).attr("src",i)},a=function(t,i,n,a,o){var r=Math.floor(i/2),e=(a+1)/2,f=Math.floor(n/t),u=Math.floor(e*f);o&&(u=f-u);var c=u-r,s=f-u,h=i-r;return s<h&&(c-=h-s),c<0&&(c=0),-100*c/i+"%"},o=function(t){var i=t.data("imageW"),r=t.data("imageH"),e=t.data("imageSrc");if(!i&&!r&&!e)return function(t){var i=t.find("img").attr("src");t.data("imageSrc",i),n(i,function(i,n){t.data({imageW:n.width,imageH:n.height}),o(t)})}(t);var f=t.width(),u=t.height(),c=parseFloat(t.data("focusX")),s=parseFloat(t.data("focusY")),h=t.find("img").first(),d=0,l=0;if(!(f>0&&u>0&&i>0&&r>0))return!1;var w=i/f,g=r/u;h.css({"max-width":"","max-height":""}),i>f&&r>u&&h.css(w>g?"max-height":"max-width","100%"),w>g?d=a(g,f,i,c):w<g&&(l=a(w,u,r,s,!0)),h.css({top:l,left:d})},r=t(window),e=function(t,i){var n,a,e,f=i.throttleDuration?(n=function(){o(t)},a=i.throttleDuration,e=!1,function(){var t=Array.prototype.slice.call(arguments,0);if(e)return!1;e=!0,setTimeout(function(){e=!1,n.apply(null,t)},a)}):function(){o(t)},u=!1;return o(t),{adjustFocus:function(){return o(t)},windowOn:function(){if(!u)return r.on("resize",f),u=!0},windowOff:function(){if(u)return r.off("resize",f),u=!1,!0}}};t.fn.focusPoint=function(n){if("string"==typeof n)return this.each(function(){t(this).data("focusPoint")[n]()});var a=t.extend({},i,n);return this.each(function(){var i=t(this),n=e(i,a);i.data("focusPoint")&&i.data("focusPoint").windowOff(),i.data("focusPoint",n),a.reCalcOnWindowResize&&n.windowOn()})},t.fn.adjustFocus=function(){return this.each(function(){o(t(this))})}}(jQuery);
